<!doctype html><html lang="en"><head><meta charset="utf-8"><title>Revealing any GitHub user&#39;s two-factor authentication settings | Jake Mulley</title><meta name="author" content="Jake Mulley"><meta name="description" content="Jake Mulley is Head of Hosting &amp; Digital Operations at Ministry of Justice, with 9 years experience across agencies, startups, the public sector, charities, and government organisations."><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="stylesheet" href="/css/main.css?v=1641543989698"><link rel="icon" href="/favicon.ico" sizes="any"><link rel="icon" href="/favicon.svg" type="image/svg+xml"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="manifest" href="/manifest.webmanifest"><meta name="theme-color" content="#DB3344"></head><body><header><a href="/"><img alt="Jake Mulley's headshot" src="/images/profile.jpeg"><h1>Revealing any GitHub user&#39;s two-factor authentication settings</h1></a><h2>Jake Mulley</h2></header><main class="content"><p><em>This vulnerability was responsibly disclosed via <a href="https://hackerone.com/github">GitHub's bug bounty program</a>. As this is now resolved, GitHub are happy for me to disclose this publicly.</em></p><h2>Summary</h2><p>You could reveal whether or not any GitHub user has two-factor authentication on or off without relying on end-user interaction.</p><p>This vulnerability was found through the GitHub Enterprise administration panel.</p><h3>The vulnerability</h3><p>GitHub Enterprise, similar to a GitHub organisation, allows you to enforce 2FA for all members and outside collaborators.</p><p>If you've had a GitHub Enterprise account for a long time and you want to enforce 2FA, you are likely to want to find out which users <em>don't</em> currently have 2FA enabled. This allows you to reach out to team members, and ask them to enable 2FA before you enforce it organisation or Enterprise wide, so you don't break their workflow. For example, the user might be using old-fashioned username and passwords for authentication on the command line, rather than a personal access token.</p><p>GitHub helps you do this by showing each organisation members 2FA status, like this:</p><img src="/images/gh-vulnerability-2fa-enabled.png" srcset="/images/gh-vulnerability-2fa-enabled.png 2x" alt="A screenshot of a GitHub user panel, showing that I had two-factor security enabled whilst part of an organisation"><p>Whilst this is appropriate and useful for within your own organisation, this is where the vulnerability lies: this particular page didn't check if you had permission to view 2FA details about the user you're viewing.</p><p>The URL of this page is:</p><pre class="language-bash"><code class="language-bash">https://github.com/enterprises/<span class="token variable">${enterpriseSlug}</span>/outside_collaborator/<span class="token variable">${githubUsername}</span></code></pre><p>This vulnerability let you change <code>${githubUsername}</code> to any GitHub user to reveal their 2FA position. For example, the URL for <em>Fake Enterprise</em> with a outside collaborator <em>jakemulley</em> would be:</p><pre class="language-bash"><code class="language-bash">https://github.com/enterprises/fake-enterprise/outside_collaborator/jakemulley</code></pre><p>If I wasn't affiliated to the organisation and had 2FA off, it would show the following:</p><img src="/images/gh-vulnerability-2fa-disabled.png" srcset="/images/gh-vulnerability-2fa-disabled.png 2x" alt="A screenshot of a GitHub user panel, showing that I had two-factor security enabled whilst part of an organisation"><p>I <em>responsibly</em> validated this by using my <a href="http://thatscotdatasci.com">partners</a> GitHub username, with his permission, as an example.</p><p>That's it - a rather simple vulnerability thanks to the beauty of guessable and hackable URLs ðŸ¤·</p><h2>Timeline</h2><ul><li>2021-08-04 - Reported</li><li>2021-08-05 - Vulnerability validated by GitHub</li><li>2021-08-10 - Severity and impact assessed by GitHub</li><li>2021-08-10 - Resolved</li></ul><h2>Resolution</h2><p>This was resolved rather quickly - from report to resolution, it was 6 days. That's pretty good.</p><p>This was my first time reporting a vulnerability via HackerOne. I'm not a cyber-security expert, and I had no idea what <a href="https://en.wikipedia.org/wiki/Common_Vulnerability_Scoring_System">CVSS</a> score I should have used for this. I didn't even know what weakness it was really. I initially disclosed it as severity: Low, and weakness: Information Disclosure.</p><p>After validating the vulnerability, GitHub proactively changed the severity to Medium, and the weakness to Missing Function Level Access Control.</p><p>GitHub's process for assessing vulnerabilities is thorough, to help them determine the appropriate bounty, the severity and the weakness:</p><ul><li>they require <em>at least</em> two GitHub security engineers to agree on the severity <strong>and</strong> the bounty amount</li><li>they use several factors to do it, including, but not limited to:<ul><li>potential exposure</li><li>how simple or complex the vulnerability is to exploit</li><li>percentage of impacted users and systems</li></ul></li></ul><p>This gave me the confidence that actually - if I had got it wrong (which I did), they'd help rectify the severity and weakness... and the bounty amount ðŸ¤‘.</p><h2>Outcome</h2><p>For them:</p><ul><li>Vulnerability resolved âœ…</li></ul><p>For me:</p><ul><li>Free GitHub Pro âœ…</li><li>Free GitHub swag âœ…</li><li>A cool new GitHub badge âœ… (<a href="https://bounty.github.com">&quot;Security Bug Bounty Hunter&quot;</a>)</li><li>An undisclosed bounty ðŸ¤‘</li></ul><nav><p><a href="/">&larr; Back home</a></p></nav></main><footer><p>ðŸ‘‹ Say hello: <a href="https://twitter.com/carboia">Twitter</a>, <a href="https://linkedin.com/in/jakemulley">LinkedIn</a>, <a href="https://github.com/jakemulley">GitHub</a>, <a href="mailto:me@jakemulley.com">e-mail</a></p><p class="meta">&copy; Jake Mulley</p></footer><script type="application/ld+json">{
    "@context": "http://schema.org/",
    "@type": "Person",
    "name": "Jake Mulley",
    "url": "https://jakemulley.com/",
    "image": "https://jakemulley.com/images/profile.jpeg",
    "email": "mailto:me@jakemulley.com",
    "sameAs": [
      "https://twitter.com/carboia",
      "https://linkedin.com/in/jakemulley",
      "https://github.com/jakemulley"
    ],
    "jobTitle": "Head of Hosting and Digital Operations",
    "worksFor": {
      "@type": "Organization",
      "name": "Ministry of Justice",
      "sameAs": "https://www.gov.uk/government/organisations/ministry-of-justice"
    }
  }</script></body></html>